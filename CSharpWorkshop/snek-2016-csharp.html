<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>SNEK 2016 - .NET Core</title>

    <meta name="description" content="C# Workshop covering Core CLR, .NET Core, and ASP.NET Core 1.0">
    <meta name="author" content="Rainer Stropek">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="../css/reveal.css">
    <link rel="stylesheet" href="../css/theme/snek.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="../lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../css/print/pdf.css' : '../css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
</head>

<body>

    <div class="reveal">

        <div class="slides">
            <section data-state="title">
                <h2 style="margin-top: 300px;">.NET Core</h2>

                <p>Rainer Stropek | <a href="http://www.timecockpit.com">time cockpit</a></p>
                <p>
                    <a href="mailto:rainer@timecockpit.com">rainer@timecockpit.com</a> |
                    <a href="http://www.software-architects.at">Blog</a> |
                    <a href="https://github.com/rstropek">GitHub</a>
                </p>

                <small>Samples see <a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop">GitHub</a></small>
            </section>

            <section data-state="content">
                <h2>Agenda (German)</h2>

                <p>
                    Als .NET-Entwickler fragt man sich momentan oft, warum Microsoft so
                    grundlegende Änderungen an .NET vornimmt. In ASP.NET 5 entdeckt man so
                    viele neue Tools, Libraries und Konzepte, dass man leicht den Überblick
                    verlieren kann. In dieser Session erklärt Rainer Stropek, was hinter
                    den Umbaumaßnahmen von Microsoft an .NET steckt.
                </p>
                <ul>
                    <li>Welche neuen Grundkonzepte stecken dahinter? </li>
                    <li>Warum und wofür sind die Änderungen sinnvoll?</li>
                    <li>Was ändert sich für die tägliche Entwicklungspraxis?</li>
                    <li>Welche Rolle spielen Open Source und Plattformunabhängigkeit?</li>
                </ul>
            </section>

            <section data-state="content">
                <section data-state="title">
                    <h2 style="margin-top: 300px;">Getting Started</h2>
                </section>
                
                <section>
                    <h2>What is .NET?</h2>
                    
                    <p>New to .NET? Need to introduce someone to .NET?<br/>
                    <small><a href="http://dotnet.github.io/docs/concepts/primer.html#key-net-concepts">Quick overview</a></small></p>

                    <p>Different implementations</p>
                    <ul>
                        <li class="fragment">
                            <p>.NET Core<br/>
                            <small>New, redesigned, cross-platform, open-source, ...</small></p>
                        </li>
                        <li class="fragment">
                            <p>.NET Native<br/>
                            <small>.NET adhead-of-time compiled</small></p>
                        </li>
                        <li class="fragment">
                            <p>.NET Framework<br/>
                            <small>Server, client, just Windows; huge .NET Framework Class Library incl. WCF, WPF, etc.</small></p>
                        </li>
                        <li class="fragment">
                            <p>Mono<br/>
                            <small>Community-driven, cross-platform, open-source; follows .NET Framework, not .NET Core</small></p>
                        </li>
                    </ul>
                </section>
                
                <section>
                    <h2>What is <i>.NET Core?</i></h2>
                    
                    <p class="fragment">Contender: <a href="https://nodejs.org/en/">Node.js</a></p>

                    <p class="fragment">.NET Runtime and framework<br/>
                        <small><a href="https://github.com/dotnet/coreclr/blob/master/Documentation/project-docs/dotnet-standards.md">ECMA 335</a> implementation</small>
                    </p>
                    <p class="fragment">Cross-platform<br/>
                        <small>Windows, Linux and MacOS</small>
                    </p>
                    <p class="fragment">Open-source</p>
                    <p class="fragment">Delivered by package manager (NuGet, APT, etc.) or Docker</p>
                    <p class="fragment">"A-la-carte" framework (take just what you need)</p>
                </section>

                <section>
                    <h2>Installation</h2>
                    
                    <ul>
                        <li>
                            Install <a href="https://go.microsoft.com/fwlink/?LinkId=532606">Visual Studio 2015</a> 
                            with Web Developer Tools</em> and 
                            <a href="https://go.microsoft.com/fwlink/?LinkId=627627">ASP.NET 5</a>
                        </li>
                        <li>
                            Install .NET Version Manager (DNVM)<br/>
                            <small>
                                <a href="https://docs.asp.net/en/latest/getting-started/index.html">
                                    Check install scripts for Windows and Linux
                                </a>
                            </small>
                        </li>
                    </ul>
                </section>

                <section>
                    <h2>Demo</h2>
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/10-console-hello-world">Sample on GitHub</a></p>
                    
                    <ul>
                        <li>Introduction to DNVM</li>
                        <li>Generate console app with Yeoman</li>
                        <li>Learn about DNU and DNX</li>
                        <li>Basics about project.json</li>
                        <li>.NET Core on Windows and Linux</li>
                    </ul>
                </section>
                
                <section>
                    <h2>DNU: DNX Utility</h2>
                    <small>Note: This will change, see <a href="https://github.com/dotnet/cli">.NET CLI</a></small>
                    
                    <p>Manage packages for your application<br/>
                    <small>
                        <a href="https://github.com/aspnet/Home/wiki/DNX-utility">
                            Detailed reference (note <code>--help</code> option)
                        </a>
                    </small>
                    </p>
                    <ul>
                        <li>Restore packages</li>
                        <li>Install packages</li>
                        <li>Publish app into self-contained directory</li>
                        <li>Build NuGet package</li>
                        <li>Produce assemblies</li>
                        <li>Lists dependencies</li>
                    </ul>
                </section>
                
                <section>
                    <h2>DNX</h2>
                    
                    <p>.NET Execution Environment</p>
                    
                    <ul>
                        <li>Cross-Platform</li>
                        <li>Build for ASP.NET web apps</li>
                        <li>Can run cross-platform console apps</li>
                        <li><a href="https://github.com/aspnet/dnx-watch"><code>dnx-watch</code> is useful during development</a></li>
                    </ul>
                    
                    <p>Note: DNX will be replaced by <a href="http://dotnet.github.io/getting-started/">.NET CLI</a>
                    (<a href="http://dotnet.github.io/docs/libraries/libraries-with-cli.html#prerequisites">details</a>)</p>
                </section>
                
                <section>
                    <h2>Resources</h2>
                    
                    <ul>
                        <li><a href="https://docs.asp.net/en/latest/getting-started/index.html">Getting Started with ASP.NET 5</a></li>
                        <li><a href="http://dotnet.github.io/">.NET Core Homepage</a> (WIP)</li>
                        <li><a href="https://github.com/dotnet/core">.NET Core Home Repo on GitHub</a></li>
                        <li><a href="https://hub.docker.com/r/microsoft/aspnet/">Docker image for ASP.NET 5</a></li>
                    </ul>
                </section>
            </section>
            
            <section data-state="content">
                <section data-state="title">
                    <h2 style="margin-top: 300px;">Projects</h2>
                    <small><code>project.json</code></small>
                </section>
                
                <section>
                    <h2>Minimum Example</h2>
                    
                    <small>Try that and note that <code>dnx run</code> fails</small>
                    
                    <pre><code class="hlcs" data-trim contenteditable>
namespace myApp
{
    public class Program
    {
        public static void Main(string[] args)
        {
        }
    }
}
                    </code></pre>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "frameworks": {
    "dnx451": {},
    "dnxcore50": {}
  },
  "commands": { 
    "run": "myApp" 
  }
}                  </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/20-from-scratch/myApp">Sample on GitHub</a></p>
                </section>
                
                <section>
                    <h2>Dependencies</h2>
                    
                    <p>
                        Add dependency to <code>System.Console</code><br/>
                        <small>Use VS (IntelliSense) or run <code>dnu install System.Console</code></small>
                    </p>
                    
                    <p>Global or framework-specific dependencies</p>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "dependencies": {
    "System.Console": "4.0.0-beta-23516"
  },
  ...
}                   </code></pre>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "dependencies": { },
  "frameworks": {
    "dnx451": {},
    "dnxcore50": {
        "dependencies": {
            "System.Console": "4.0.0-beta-23516"
        }
    }
  }, ...
}                    </code></pre>
                </section>
                
                <section>
                    <h2>Project Lock File</h2>
                    
                    <p>Cache for package dependencies<br/>
                    <small>Better performance because of significantly less disk IO</small></p>
                    
                    <p>Generated when running <code>dnu restore</code></p>
                    <p>Prerequisite for running <code>dnx</code></p>
                    <p><code>locked</code> field used to suppress dependency graph walking<br/>
                    <small><code>dnu [ --lock | --unlock ]</code></small></p>
                </section>
                
                <section>
                    <h2>Commands</h2>
                    
                    <p>
                        Entry points with arguments (used e.g. by <a href="http://docs.efproject.net/en/latest/platforms/aspnetcore/new-db.html#install-entity-framework">EF 7</a>
                        and <a href="https://docs.asp.net/en/latest/fundamentals/servers.html">Kestrel</a>)
                    </p>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "dependencies": { },
  "frameworks": { ... },
  "commands": {
    "run": "myApp --target world"
  }
}                    </code></pre>
                    
                    <pre><code class="hlcs" data-trim contenteditable>
public static void Main(string[] args) 
{
    if (args.Length != 2 || args[0] != "--target") {
        System.Console.WriteLine("Missing parameter --target");
    } 
    else {
        System.Console.WriteLine($"Hello {args[1]}");
    }
}
                    </code></pre>
                    
                    <small><a href="https://docs.asp.net/en/latest/dnx/commands.html">Details</a> about global commands</small>
                </section>
                
                <section>
                    <h2>Compilation Settings</h2>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "compilationOptions": {
    "define": ["SOMETHING"],
    "allowUnsafe": true,
    "warningsAsErrors" : true,
    "languageVersion": "experimental"
  }
}
                    </code></pre>
                    
                    <p>Use <code>configurations</code> to create named groups of settings<br/>
                    <small><code>dnu build --configuration Debug</code></small></p>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "configurations": {
    "Debug": { "compilationOptions": { ... } },
    "Release": { "compilationOptions": { ... } }
  }
}
                    </code></pre>
                </section>
                
                <section>
                    <h2>Including/Excluding Files</h2>
                    
                    <ul>
                        <li><code>compile</code>: What should be compiled?
                        <li><code>exclude</code>: What should be totally ignored?
                        <li><code>publishExclude</code>: What should be ignored for publishing?
                    </ul>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "compile": "*.cs",
  "exclude": [
    "node_modules",
    "bower_components"
  ],
  "publishExclude": [
    "**.xproj",
    "**.user",
    "**.vspscc"
  ]
}
                    </code></pre>

                    <p>Use <a href="https://en.wikipedia.org/wiki/Glob_(programming)">glob patterns</a><br/>
                    <small><a href="https://docs.asp.net/en/latest/dnx/projects.html#building">More details</a> about include/exclude settings</small></p>
                    
                </section>

                <section>
                    <h2>Sharing Files</h2>
                    
                    <p>Compile code in shared directory as if it was part of the project<br/>
                    <small>Note: Use <code>internal</code> types only</small></p>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
    "dependencies": {
        "System.Console": "4.0.0-beta-23516"
    },
    "frameworks": {
        "dnxcore50": {}
    },
    "shared": "*.cs"
}
                    </code></pre>
                    
                    <img src="../img/nuget-shared.png" />
                    
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/30-shared-project">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>Libraries</h2>
                    
                    <p>Projects are just folders with files in them</p>
                    <p><code>global.json</code> at the top level needs the names of each project (folder name)</p>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
    "projects":[
        "consumer",
        "lib"
    ]
}
                    </code></pre>

                    <p><code>project.json</code> includes a reference</p>

                    <pre><code class="hljson" data-trim contenteditable>
{
    "dependencies": {
        "lib": "",
        ...
    },
    ...
}
                    </code></pre>      
                    
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/40-library">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>Creating NuGet Packages</h2>
                    
                    <p>Create NuGet package with DNU<br/>
                    <small><code>dnu pack [ --configuration ... ]</code></small></p>
                    
                    <img src="../img/nuget-lib.png" />
                    
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/40-library">Sample on GitHub</a></p>
                </section>
                
                <section>
                    <h2>Package Metadata</h2>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
    "title": ".NET Core Demo",
    "authors": [ "Rainer Stropek" ],
    "version": "1.0.0",
    "copyright": "MIT License",
    "description": "This is small sample for .NET Core",
    ...
}
                    </code></pre>
                    <small><a href="https://docs.asp.net/en/latest/dnx/projects.html#building">More details</a> about package metadata</small></p>
                </section>
                
                <section>
                    <h2>Script</h2>
                    
                    <p>Add scripts to <code>project.json</code><br/>
                    <small>Used for e.g. <code>npm</code>, <code>gulp</code>, etc.</small></p>
                    
                    <pre><code class="hljson" data-trim contenteditable>
{
  "scripts": {
    "prebuild": "executed before building",
    "postbuild": "executed after building",
    "prepack": "executed before packing",
    "postpack": "executed after packing",
    "prepublish": "executed before publish",
    "postpublish": "executed after publish",
    "prerestore": "executed before restoring packages",
    "postrestore": "executed after restoring packages",
    "prepare": "After postrestore but before prepublish"
  }
}
                    </code></pre>

                    <small><a href="https://docs.asp.net/en/latest/dnx/projects.html#scripts">More details</a> about scripts</small></p>
                </section>                 
                
                <section>
                    <h2>Resources</h2>
                    
                    <ul>
                        <li><a href="https://docs.asp.net/en/latest/dnx/projects.html">Working with DNX Projects</a></li>
                        <li><a href="https://en.wikipedia.org/wiki/Glob_(programming)">Glob patterns</a></li>
                        <li><a href="http://dotnet.github.io/docs/">.NET Core documentation</a></li>
                        <li><a href="http://www.hanselman.com/blog/ExploringTheNewNETDotnetCommandLineInterfaceCLI.aspx">Scott Hanselman about dotnet CLI</a></li>
                    </ul>
                </section>
            </section>

            <section data-state="content">
                <section data-state="title">
                    <h2 style="margin-top: 300px;">ASP.NET Fundamentals</h2>
                </section>
                
                <section>
                    <h2>Startup</h2>
                    
                    <p><code>Main</code> in our code or in referenced assemblies<br/>
                    <small>See e.g. <a href="https://github.com/aspnet/KestrelHttpServer/blob/1.0.0-rc1/src/Microsoft.AspNet.Server.Kestrel/Program.cs">Kestrel's <code>Main</code> method</a></small></p>

                    <pre><code class="hlcs" data-trim contenteditable>
public class Program
{
    public void Main(string[] args) => WebApplication.Run&lt;Startup&gt;(args);
}
                    </code></pre>

                    <p><a href="https://docs.asp.net/en/latest/fundamentals/startup.html#the-startup-class">Startup</a> 
                    class is detected based on conventions<br/>
                    <small>Supports <a href="https://docs.asp.net/en/latest/fundamentals/environments.html#startup-conventions">multiple environments</a></small></p> 

                    <pre><code class="hlcs" data-trim contenteditable>
public class Startup
{
    public void ConfigureServices(IServiceCollection services)
    { ... }

    public void Configure(IApplicationBuilder app)
    { ... }
}
                        </code></pre>
                    
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/50-simplest-aspnet/myApp">Sample on GitHub</a></p>
                </section>
                         
                <section>
                    <h2>Startup Services</h2>
                    
                    <p>During startup, application services are available<br/>
                    <small><a href="https://docs.asp.net/en/latest/fundamentals/startup.html#services-available-in-startup">List of services</a></small></p>

                    <pre><code class="hlcs" data-trim contenteditable>
public class Startup
{
    // Note constructor injection here
    public Startup(IApplicationEnvironment appEnv, IHostingEnvironment env)
    {
        Console.WriteLine($"App name: {appEnv.ApplicationName}");
        Console.WriteLine($"Root path: {env.WebRootPath}");
    }
    ...
}
                    </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/50-simplest-aspnet/myApp">Sample on GitHub</a></p>
                </section>
                         
                <section>
                    <h2><code>Configure</code> and <code>ConfigureServices</code></h2>

                    <ul>
                        <li>
                            <a href="https://docs.asp.net/en/latest/fundamentals/startup.html#the-configureservices-method"><code>ConfigureServices</code></a> (optional):
                            Configure <a href="https://docs.asp.net/en/latest/fundamentals/dependency-injection.html">dependency injection</a>.
                        </li>
                        <li>
                            <a href="https://docs.asp.net/en/latest/fundamentals/startup.html#the-configure-method"><code>Configure</code></a>:
                            Build pipeline by e.g. adding <a href="https://docs.asp.net/en/latest/fundamentals/middleware.html">middlewares</a>.
                        </li>
                    </ul>                    
                        
                    <pre><code class="hlcs" data-trim contenteditable>
public void Configure(IApplicationBuilder app)
{
    app.Use(async (context, next) => {
        await context.Response.WriteAsync(">>> Hello ");
        await next();
        await context.Response.WriteAsync("World <<<");
    });
    app.Map("/beautiful", beautifulApp => beautifulApp.Run(
        async context => await context.Response.WriteAsync("beautiful ")));
}
                    </code></pre>

                    <p>Note: Encapsulate complex logic in middleware<br/>
                    <small><a href="https://docs.asp.net/en/latest/fundamentals/middleware.html">Details</a></small></p>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/50-simplest-aspnet/myApp">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>Visual Studio Demo</h2>
                    
                    <ul>
                        <li>Create empty ASP.NET 5 project<br/>
                        <small>Walkthrough generated code</small></li>
                        <li>Add <code>Microsoft.AspNet.StaticFiles</code> dependency<br/>
                        <small><a href="https://docs.asp.net/en/latest/fundamentals/static-files.html">More about static files</a></small></li>
                        <li>Add static files middleware in <code>Configure</code></li>
                        <li>Run in IIS with <a href="https://docs.asp.net/en/latest/hosting/http-platformhandler.html">HTTP Platform Handler</a></li>
                        <li>Run with <code>dnx web</code> (self-hosted)</li>
                        <li>Publish to Azure from Visual Studio</li>
                    </ul>
                </section>

                <section>
                    <h2>Linux Demo with <a href="https://www.docker.com/">Docker</a></h2>
                    
                    <ul>
                        <li>Connect to VM in Azure with PuTTY</li>
                        <li>Copy sample to VM with FileZilla</li>
                        <li>Get <a href="https://hub.docker.com/r/microsoft/aspnet/">ASP.NET Docker Image</a></li>
                        <li>Start Docker container<br/>
                        <small><code>docker run -it -v ~/myApp:/src -p 80:5000 microsoft/aspnet /bin/bash</code></small></li>
                        <li>Start web app and show it in browser</li> 
                    </ul>
                        
                    <pre><code class="hlbash" data-trim contenteditable>
dnvm install 1.0.0-rc1-update1 -r coreclr
dnvm use 1.0.0-rc1-update1 -r mono
dnu restore
dnvm use 1.0.0-rc1-update1 -r coreclr
dnx web
                    </code></pre>
                    
                    <p>
                        <small><a href="https://github.com/dotnet/coreclr/blob/master/Documentation/install/get-dotnetcore-dnx-linux.md">Details about DNX on Linux</a><br/>
                        <a href="http://blogs.msdn.com/b/rdcdev/archive/2015/08/28/some-issues-when-hosting-asp-net-5-on-ubuntu-on-azure.aspx">Issus about DNX on LInx</a></small>
                    </p>
                </section>
                         
                <section>
                    <h2>Diagnostics</h2>

                    <p>Control environment with environment variables<br/>
                    <small>Can be done directly in VS</small></p>
                        
                    <pre><code class="hlcs" data-trim contenteditable>
public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
    if (env.IsDevelopment())
    {
        // Running in development mode
        app.UseDeveloperExceptionPage();
        app.UseRuntimeInfoPage();
    }

    app.Use(async (context, next) =>
    {
        if (context.Request.Query.ContainsKey("exception"))
        {
            throw new InvalidOperationException("Something bad happened ...");
        }

        await next();
    });
    ...
}
                    </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/90-aspnet-angular">Sample on GitHub</a></p>
                </section>
                         
                <section>
                    <h2>Configuration</h2>

                    <p>No <code>web.config</code> anymore</p>
                    <p>Key/value pair settings from different providers<br/>
                    <small>E.g. memory, environment variables, JSON, INI, XML</small></p>
                    <p>Extensible<br/>
                    <small><a href="https://docs.asp.net/en/latest/fundamentals/configuration.html#writing-custom-providers">Details about writing custom providers</a></small></p>
                    <p><a href="https://docs.asp.net/en/latest/fundamentals/configuration.html#using-options-and-configuration-objects">Options pattern</a> for DI integration</p>
                </section>

                <section>
                    <h2>Configuration Demo</h2>
                    
                    <ul>
                        <li>In-memory configuration</li>
                        <li>JSON configuration</li>
                        <li>Configuration via command line</li>
                        <li>Configuration with environment variables</li>
                        <li>Options pattern</li>
                    </ul>
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/55-configuration/myApp">Sample on GitHub</a></p>
                    <p>See <a href="https://github.com/Microsoft/ApplicationInsights-aspnetcore/blob/v1.0.0-rc1/src/Microsoft.ApplicationInsights.AspNet/Extensions/ApplicationInsightsExtensions.cs#L113-L151">practical use in AppInsights</a></p>
                </section>
                         
                <section>
                    <h2>Logging</h2>

                    <p>Support for logging built into ASP.NET Core</p>
                    <p>Various logger built in<br/>
                    <small>E.g. console, NLog</small></p>
                    <p><a href="https://docs.asp.net/en/latest/fundamentals/logging.html">Details about logging</a></p>
                    
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/90-aspnet-angular">Sample on GitHub</a></p>
                </section>
                         
                <section>
                    <h2>Dependency Injection</h2>

                    <p>Support for DI built into ASP.NET Core<br/>
                    <small><a href="https://docs.asp.net/en/latest/fundamentals/dependency-injection.html">Details about DI</a></small></p>
                    <p>Framework-provided services and your own services</p>
                    <p>Default container can be replaced<br/>
                    <small><a href="https://docs.asp.net/en/latest/fundamentals/dependency-injection.html#replacing-the-default-services-container">Details</a></small></p>
                        
                    <pre><code class="hlcs" data-trim contenteditable>
public void ConfigureServices(IServiceCollection services)
{
    ...
    // My own service
    services.AddSingleton(typeof(INameGenerator), typeof(NameGenerator));
    ...
    // Framework services
    services.AddApplicationInsightsTelemetry(configuration);
    services.AddCors();
    services.AddMvc();
    ...
}
                    </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/90-aspnet-angular">Sample on GitHub</a></p>
                </section>
                         
                <section>
                    <h2>DI Service Lifetime</h2>

                    <ul>
                        <li>Transient</li>
                        <li>Scoped</li>
                        <li>Singleton</li>
                        <li>Instance</li>
                    </ul>
                        
                    <pre><code class="hlcs" data-trim contenteditable>
public void ConfigureServices(IServiceCollection services)
{
    services.AddSingleton&lt;MySingletonService&gt;();
    services.AddTransient&lt;MyTransientService&gt;();
    services.AddScoped&lt;MyScopedService&gt;();
    
    services.AddMvc();
}
                    </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/60-di-scopes/myApp">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>ASP.NET Core Demo</h2>
                    
                    <p>Build end-to-end sample app with server and client components</p>
                    
                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/90-aspnet-angular">Sample on GitHub</a></p>
                </section>
            </section>

            <section data-state="content">
                <section data-state="title">
                    <h2 style="margin-top: 300px;">Unit Testing</h2>
                </section>

                <section>
                    <h2>Test Frameworks and Runners</h2>

                    <p>DNX supports/will support multiple test frameworks</p>

                    <p>Current, <a href="https://xunit.github.io/">XUnit</a> is preferred</p>

                    <p>Used to MSTest but new to XUnit? <a href="https://xunit.github.io/docs/comparisons.html">Compare ...</a></p>
                </section>

                <section>
                    <h2>Project Setup</h2>

                    <p>Create <code>global.json</code> referencing projects</p>

                    <pre><code class="hljs" data-trim contenteditable>
{
    "projects":[
        "src/client",
        "src/math-library",
        "test/lib-test"
    ]
}
                    </code></pre>

                    <img src="../img/test-project-structure.png" style="max-height: 250px;" />

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/70-xunit">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>Writing tests</h2>

                    <p><code>project.json</code></p>

                    <pre><code class="hljs" data-trim contenteditable>
{
    "dependencies": {
        "xunit": "2.1.0",
        "xunit.runner.dnx": "2.1.0-rc1-build204",
        "math-library": ""
    },
    "frameworks": {
        "dnxcore50": {}
    },
    "commands": {
        "test": "xunit.runner.dnx"
    }
}
                    </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/70-xunit">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>Writing tests</h2>

                    <pre><code class="hlcs" data-trim contenteditable>
using Xunit;
namespace Tests
{
    public class TestClass
    {
        [Fact]
        public void TestAdd()
        {
            Assert.Equal(2, Library.Math.Add(1, 1));
        }
        ...
    }
}
                    </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/70-xunit">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>Running tests</h2>

                    <p><code>dnx test</code></p>

                    <img src="../img/test-result.png" />

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/70-xunit">Sample on GitHub</a></p>
                </section>
            </section>

            <section data-state="content">
                <section data-state="title">
                    <h2 style="margin-top: 300px;">News in Visual Studio 2015 Update 1</h2>
                </section>

                <section>
                    <h2>Goto Implementation :-)</h2>

                    <img src="../img/visual-studio-goto-implementation.png" />
                </section>

                <section>
                    <h2>C# Scripting</h2>

                    <p>
                        <a href="https://github.com/dotnet/roslyn/wiki/Scripting-API-Samples">Roslyn Scripting API</a> for C#<br />
                        <small>Finally back ;-)</small>
                    </p>

                    <pre><code class="hljson" data-trim contenteditable>
{
"dependencies": {
...
"Microsoft.CodeAnalysis.CSharp.Scripting": "1.1.1"
}, ...
}
                </code></pre>

                    <p><code>csi.exe</code> for running C# scripts in dev command prompt</p>
                    <p>C# Interactive Windows in VS</p>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/AspNetCore1Workshop/65-csharp-scripting/myApp">Sample on GitHub</a></p>
                </section>

                <section>
                    <h2>Parallel Test Execution</h2>

                    <p>
                        VS2015 Update 1 can run tests in parallel on multi-core<br />
                        <small>Must be separate assemblies, distinct processes</small>
                    </p>

                    <img src="../img/visual-studio-testsettings.png" />

                    <pre><code class="hljson" data-trim contenteditable>
&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;RunSettings&gt;
&lt;RunConfiguration&gt;
&lt;MaxCpuCount&gt;8&lt;/MaxCpuCount&gt;
&lt;/RunConfiguration&gt;
&lt;/RunSettings&gt;
                </code></pre>

                    <p><a href="https://github.com/rstropek/Samples/tree/master/ParallelTestExecution">Sample on GitHub</a></p>
                </section>
            </section>

            <section data-state="title">
                <h2 style="margin-top: 300px;">Thank you for attending!</h2>

                <p>See you next SNEK!</p>
            </section>
        </div>

		<div class="footer">
			SNEK 2016<br />
			Rainer Stropek | <a href="http://www.software-architects.at">software architects</a>
		</div>
    </div>

	<script src="../js/jquery.min.js"></script>
    <script src="../lib/js/head.min.js"></script>
    <script src="../js/reveal.js"></script>
	<script src="../js/util.js"></script>

    <script>
        // Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
                margin: 0.1,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../plugin/zoom-js/zoom.js', async: true },
					{ src: '../plugin/notes/notes.js', async: true }
				]
			});
            
            Reveal.configure({
                slideNumber: true
            })
    </script>

</body>

</html>